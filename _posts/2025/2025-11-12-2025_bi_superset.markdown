---
layout: page
title: ä½¿ç”¨ Dockerâ€¯Compose å®‰è£… Apache Superset
category: å·¥å…·
tags: Superset
---

## å®‰è£…æ­¥éª¤

1. **å®‰è£…å‰å‡†å¤‡**
   ç¡®ä¿æ‚¨çš„æœºå™¨å·²å®‰è£…ï¼š

   * Docker
   * Docker Composeï¼ˆæ¨èä½¿ç”¨ `docker compose` æ–°è¯­æ³•ï¼‰
   * Git

2. **è·å–é¡¹ç›®ä»£ç **

   ```bash
   git clone https://github.com/apache/superset
   cd superset
   ```

3. **åˆ‡æ¢åˆ°æŒ‡å®šç‰ˆæœ¬ï¼ˆå¯é€‰ï¼‰**
   ä¸ºä¿æŒç¨³å®šï¼Œæ¨èåˆ‡æ¢è‡³å®˜æ–¹å‘å¸ƒæ ‡ç­¾ï¼Œä¾‹å¦‚ï¼š

   ```bash
   git checkout tags/5.0.0
   ```

4. **é…ç½® `.env` æ–‡ä»¶**
   åœ¨é¡¹ç›®æ ¹ç›®å½•ï¼Œå¤åˆ¶æˆ–ä¿®æ”¹ `.env` æ–‡ä»¶ï¼Œå¹¶ç¡®è®¤å¦‚ä¸‹å…³é”®é…ç½®ï¼ˆç¤ºä¾‹ï¼‰ï¼š

   ```env
   DATABASE_USER=superset
   DATABASE_PASSWORD=superset
   DATABASE_DB=superset

   EXAMPLES_DB=examples
   EXAMPLES_USER=examples
   EXAMPLES_PASSWORD=examples

   SUPERSET_LOAD_EXAMPLES=no
   ```

5. **å¯åŠ¨ Superset å®¹å™¨**
   ä½¿ç”¨ Docker Compose å¯åŠ¨ï¼š

   ```bash
   docker compose -f dockerâ€‘composeâ€‘imageâ€‘tag.yml up -d --build
   ```

6. **è®¿é—® Superset**
   å®¹å™¨å¯åŠ¨å®Œæˆåï¼Œåœ¨æµè§ˆå™¨æ‰“å¼€ï¼š

   ```
   http://localhost:8088
   ```

   ä½¿ç”¨é»˜è®¤è´¦å·ï¼ˆä¾‹å¦‚ `admin` / `admin`ï¼‰ç™»å½•ã€‚

7. **åœæ­¢æœåŠ¡ï¼ˆå¯é€‰ï¼‰**
   å½“ä¸å†ä½¿ç”¨æ—¶ï¼Œå¯ä»¥è¿™æ ·å…³é—­ï¼š

   ```bash
   docker compose -f dockerâ€‘composeâ€‘imageâ€‘tag.yml down
   ```

---

## é‡åˆ°çš„å¸¸è§é—®é¢˜ä¸è§£å†³åŠæ³•

### ğŸ”¹ é—®é¢˜â€¯1ï¼šåˆå§‹åŒ–è„šæœ¬æƒé™è¢«æ‹’ç»

```
exec: "/app/docker/docker-init.sh": permission denied
```

**åŸå› **ï¼šå®¹å™¨å¯åŠ¨è„šæœ¬ç¼ºå°‘æ‰§è¡Œæƒé™ã€‚
**è§£å†³**ï¼šåœ¨å®¿ä¸»æœºæ‰§è¡Œ `chmod +x docker/docker-init.sh`ï¼Œç„¶åé‡å»ºé•œåƒã€‚

---

### ğŸ”¹ é—®é¢˜â€¯2ï¼šPostgreSQL æ•°æ®ç›®å½•ç‰ˆæœ¬ä¸å…¼å®¹

```
FATAL: database files are incompatible with server  
DETAIL: The data directory was initialized by PostgreSQL version 16, which is not compatible with this version 15.14
```

**åŸå› **ï¼šæ•°æ®å·ä¸­å·²æœ‰ç”±è¾ƒæ–° PostgreSQL ç‰ˆæœ¬åˆå§‹åŒ–çš„ç›®å½•ï¼Œè€Œé•œåƒä½¿ç”¨è¾ƒæ—§ç‰ˆæœ¬ã€‚
**è§£å†³**ï¼šåˆ é™¤æ—§å·æˆ–æ›´æ¢é•œåƒç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼š

```bash
docker volume rm superset_db_data
docker compose down â€‘v
docker compose up â€‘d â€‘â€‘build
```

---

### ğŸ”¹ é—®é¢˜â€¯3ï¼šç¤ºä¾‹æ•°æ®åŠ è½½å¤±è´¥ï¼ç½‘ç»œä¸å¯è¾¾

```
urllib.error.URLError: <urlopen error [Errno 101] Network is unreachable>
```

**åŸå› **ï¼š

* å®¹å™¨æ— æ³•è®¿é—®å¤–ç½‘ï¼Œå¯¼è‡´ä¸‹è½½ç¤ºä¾‹æ•°æ®å¤±è´¥ã€‚
* è™½ç„¶åœ¨ `.env` ä¸­å†™äº† `SUPERSET_LOAD_EXAMPLES=no`ï¼Œä½†æœåŠ¡ä»æ—§ä»¥ `yes` å¯åŠ¨ã€‚

**è§£å†³**ï¼š

* ç¡®è®¤ `.env` ä¸­ `SUPERSET_LOAD_EXAMPLES=no` ç”Ÿæ•ˆã€‚
* æ£€æŸ¥ `dockerâ€‘composeâ€‘imageâ€‘tag.yml` ä¸­æ˜¯å¦æœ‰æœåŠ¡ç¯å¢ƒå˜é‡ç¡¬ç¼–ç  `SUPERSET_LOAD_EXAMPLES: "${SUPERSET_LOAD_EXAMPLES:-yes}"`ï¼Œè‹¥æ˜¯åˆ™ç›´æ¥å°†å…¶æ”¹ä¸º `â€œnoâ€`ã€‚
* å®Œæ•´é‡å»ºæœåŠ¡ï¼š

  ```bash
  docker compose down â€‘v â€‘â€‘rmi all
  docker compose up â€‘d â€‘â€‘build
  ```

---

### ğŸ”¹ é—®é¢˜â€¯4ï¼šé•œåƒæ‹‰å–å¤±è´¥æˆ–å…ƒæ•°æ®æ ¡éªŒå¤±è´¥

```
failed to resolve source metadata for docker.io/library/python:3.11.13â€‘slimâ€‘bookworm
failed size validation: ...
```

**åŸå› **ï¼šé•œåƒç¼“å­˜æŸåã€ç½‘ç»œä¸ç¨³å®šæˆ–é•œåƒæºé—®é¢˜ã€‚
**è§£å†³**ï¼š

```bash
docker system prune â€‘a
docker compose build â€‘â€‘noâ€‘cache
```

æˆ–æ¢ç”¨é•œåƒåŠ é€Ÿå™¨ã€‚

---

## 4ï¸âƒ£ æ€»ç»“ç»éªŒ

* `.env` æ–‡ä»¶ä¿®æ”¹ **å¿…é¡»** åœ¨å®¹å™¨æ„å»ºä¹‹å‰å®Œæˆï¼Œå¦åˆ™ Compose ä¼šä½¿ç”¨é»˜è®¤å€¼ã€‚
* `SUPERSET_LOAD_EXAMPLES` è¦åŒæ—¶ç¡®è®¤ `.env` å’Œ `dockerâ€‘compose` æ–‡ä»¶ä¸­ï¼Œé¿å…â€œè®¾äº†ä½†æ˜¯æ²¡ç”Ÿæ•ˆâ€çš„æƒ…å†µã€‚
* æœ‰æ•°æ®å·/æ•°æ®åº“ç‰ˆæœ¬å†²çªæ—¶ï¼Œåˆ é™¤å·é‡æ–°åˆå§‹åŒ–æ˜¯å¿«æ·ä¸”å¯é çš„æ–¹æ³•ã€‚
* æ—¥å¿—ã€`docker compose config` è¾“å‡ºã€ç¯å¢ƒå˜é‡æ£€æŸ¥æ˜¯å®šä½é—®é¢˜çš„å…³é”®æ‰‹æ®µã€‚
* æŒ‰ç…§å®˜æ–¹å¿«é€Ÿå…¥é—¨æµç¨‹ï¼Œå¯åœ¨å‡ åˆ†é’Ÿå†…å¯åŠ¨ Superset åšè¯•éªŒï¼Œä½†ç”¨äºç”Ÿäº§è¿˜éœ€è¿›ä¸€æ­¥é…ç½®ï¼ˆä¾‹å¦‚ HTTPSã€ç”¨æˆ·æƒé™ã€æŒä¹…åŒ–å­˜å‚¨ç­‰ï¼‰([superset.org.cn][1])

---

[1]: https://superset.org.cn/docs/quickstart/ "å¿«é€Ÿå…¥é—¨ | Superset æ•°æ®å¯è§†åŒ–å¹³å°"
