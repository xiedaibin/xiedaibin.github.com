---
layout: page
title: C# ä¸­ä½¿ç”¨ä½è¿ç®—ç®¡ç†æšä¸¾æ ‡å¿—ä½ï¼ˆFlagsï¼‰
category: æŠ€æœ¯
tags: NET
---

åœ¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°â€œå¤šçŠ¶æ€ç»„åˆâ€çš„åœºæ™¯ï¼Œæ¯”å¦‚ä¸€ä¸ªç®±å­æ˜¯å¦éœ€è¦æ¸©æ§ã€æ˜¯å¦ä¸ºå±é™©å“ã€æ˜¯å¦è¶…å¤§ã€æ˜¯å¦æ˜“ç¢ç­‰ã€‚ä½¿ç”¨æ™®é€šå¸ƒå°”å˜é‡ä¼šå¾ˆéš¾ç»´æŠ¤ï¼Œè€Œä½¿ç”¨å¸¦æœ‰ `[Flags]` ç‰¹æ€§çš„æšä¸¾é…åˆä½è¿ç®—ï¼Œåˆ™æ˜¯ä¸€ä¸ªä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚

æœ¬æ–‡å°†é€šè¿‡ä¸€ä¸ªå®é™…çš„â€œç®±å­˜å‚¨è´¹æ ‡è®°â€ä¾‹å­ï¼Œè®²è§£ `|=`, `&= ~` è¿™äº›ä½è¿ç®—çš„ä½¿ç”¨æ–¹å¼ã€‚

---

## ğŸ¯ åœºæ™¯æè¿°

```csharp
/// <summary>
/// ç®±å­˜å‚¨è´¹æ ‡è®°(ç”¨äºæ ‡è®°æ˜¯å¦è®¡ç®—ç‰¹æ®Šå­˜å‚¨è´¹)
/// </summary>
[Comment("ç®±å­˜å‚¨è´¹æ ‡è®°")]
public virtual BoxStorageFeeFlagType StorageFeeFlag { get; private set; }

/// <summary>
/// æ–°å¢ç®±å­˜å‚¨è´¹æ ‡è®°
/// </summary>
public WarehouseBox AddStorageFeeFlag(BoxStorageFeeFlagType StorageFeeFlag)
{
    this.StorageFeeFlag |= StorageFeeFlag;
    return this;
}

/// <summary>
/// ç§»é™¤ç®±å­˜å‚¨è´¹æ ‡è®°
/// </summary>
public WarehouseBox RemoveStorageFeeFlag(BoxStorageFeeFlagType StorageFeeFlag)
{
    this.StorageFeeFlag &= ~StorageFeeFlag;
    return this;
}
```

---

## ğŸ§¾ å®šä¹‰ Flags æšä¸¾

```csharp
[Flags]
public enum BoxStorageFeeFlagType
{
    None = 0,
    TemperatureControlled = 1,  // 0001
    Hazardous = 2,              // 0010
    Oversized = 4,              // 0100
    Fragile = 8                 // 1000
}
```

åŠ ä¸Š `[Flags]` ç‰¹æ€§ï¼Œå¯ä»¥ä½¿å¤šä¸ªå€¼ç»„åˆæ˜¾ç¤ºæ›´å‹å¥½ï¼Œä¾‹å¦‚è¾“å‡ºä¸ºï¼š

```
TemperatureControlled, Fragile
```

---

## ğŸ§  ä½è¿ç®—åŸºæœ¬æ“ä½œ

| æ“ä½œ        | å«ä¹‰          | ç¤ºä¾‹                     | æ•ˆæœ               |            |                 |
| --------- | ----------- | ---------------------- | ---------------- | ---------- | --------------- |
| \`        | =\`         | æŒ‰ä½æˆ–ï¼ˆæ·»åŠ æ ‡è®°ï¼‰              | \`flags          | = FlagA;\` | å°† FlagA æ·»åŠ è¿›ç°æœ‰æ ‡å¿— |
| `&= ~`    | æŒ‰ä½ä¸å–åï¼ˆç§»é™¤æ ‡è®°ï¼‰ | `flags &= ~FlagA;`     | å°† FlagA ä»ç°æœ‰æ ‡å¿—ä¸­ç§»é™¤ |            |                 |
| `HasFlag` | åˆ¤æ–­æ ‡å¿—æ˜¯å¦å­˜åœ¨    | `flags.HasFlag(FlagA)` | è¿”å›æ˜¯å¦åŒ…å« FlagA     |            |                 |

---

## ğŸ–¼ å›¾ç¤ºï¼šæ·»åŠ ä¸ç§»é™¤æ ‡å¿—

### âœ… æ·»åŠ æ ‡å¿—ï¼ˆ`|=`ï¼‰

```csharp
box.AddStorageFeeFlag(BoxStorageFeeFlagType.Fragile);
```

å‡è®¾å½“å‰æ ‡å¿—ä¸ºï¼š

```
0001  (TemperatureControlled)
```

æ·»åŠ  Fragileï¼ˆ1000ï¼‰åï¼š

```
0001
| 1000
= 1001
```

ğŸ§¾ æœ€ç»ˆå€¼ï¼š`TemperatureControlled, Fragile`

---

### âŒ ç§»é™¤æ ‡å¿—ï¼ˆ`&= ~`ï¼‰

```csharp
box.RemoveStorageFeeFlag(BoxStorageFeeFlagType.TemperatureControlled);
```

å½“å‰å€¼ï¼š

```
1001  (TemperatureControlled + Fragile)
```

ç§»é™¤ TemperatureControlledï¼ˆ0001ï¼‰ï¼š

```
~0001 = 1110
1001 & 1110 = 1000
```

ğŸ§¾ æœ€ç»ˆå€¼ï¼š`Fragile`

---

## ğŸ§ª ç¤ºä¾‹ä»£ç æ¼”ç¤º

```csharp
var box = new WarehouseBox();

box.AddStorageFeeFlag(BoxStorageFeeFlagType.TemperatureControlled);
box.AddStorageFeeFlag(BoxStorageFeeFlagType.Fragile);
Console.WriteLine(box.StorageFeeFlag);
// è¾“å‡º: TemperatureControlled, Fragile

box.RemoveStorageFeeFlag(BoxStorageFeeFlagType.TemperatureControlled);
Console.WriteLine(box.StorageFeeFlag);
// è¾“å‡º: Fragile
```

---

## âœ… æ€»ç»“

ä½¿ç”¨ä½è¿ç®—ç»“åˆ `[Flags]` æšä¸¾èƒ½å¤§å¹…æå‡å¤šçŠ¶æ€æ ‡å¿—çš„è¡¨ç¤ºåŠ›å’Œå¯ç»´æŠ¤æ€§ï¼š

* `|=` æ·»åŠ æ ‡è®°
* `&= ~` ç§»é™¤æ ‡è®°
* `HasFlag()` åˆ¤æ–­æ˜¯å¦å­˜åœ¨æŸä¸ªæ ‡è®°

ä¸ä»…ä»£ç ç®€æ´ï¼Œè€Œä¸”è¿è¡Œæ•ˆç‡æé«˜ï¼Œæ˜¯å¤„ç†ç±»ä¼¼æƒé™ã€çŠ¶æ€ã€åŠŸèƒ½å¼€å…³ç­‰åœºæ™¯çš„ç†æƒ³æ–¹æ¡ˆã€‚
